(function(e){var c={reCalcOnWindowResize:true,throttleDuration:17};var i=function(j){var k=j.find("img").attr("src");j.data("imageSrc",k);h(k,function(l,m){j.data({imageW:m.width,imageH:m.height});b(j)})};var h=function(k,j){e("<img />").one("load",function(){j(null,{width:this.width,height:this.height})}).attr("src",k)};var g=function(k,j){var l=false;return function(){var m=Array.prototype.slice.call(arguments,0);if(l){return false}l=true;setTimeout(function(){l=false;k.apply(null,m)},j)}};var d=function(m,j,o,k,l){var r=Math.floor(j/2);var t=(k+1)/2;var p=Math.floor(o/m);var u=Math.floor(t*p);if(l){u=p-u}var n=u-r;var s=p-u;var q=j-r;if(s<q){n-=q-s}if(n<0){n=0}return(n*-100/j)+"%"};var b=function(w){var v=w.data("imageW");var s=w.data("imageH");var t=w.data("imageSrc");if(!v&&!s&&!t){return i(w)}var q=w.width();var k=w.height();var p=parseFloat(w.data("focusX"));var o=parseFloat(w.data("focusY"));var n=w.find("img").first();var r=n.attr("src");var u=0;var l=0;if(!(q>0&&k>0&&v>0&&s>0)){return false}var j=v/q;var m=s/k;n.css({"max-width":"","max-height":""});if(v>q&&s>k){n.css((j>m)?"max-height":"max-width","100%")}if(j>m){u=d(m,q,v,p);n.css("height","100%");n.css("width","auto")}else{if(j<m){l=d(j,k,s,o,true);n.css("width","100%");n.css("height","auto")}}n.css({top:l,left:u,opacity:1})};var a=e(window);var f=function(j,k){var m=k.throttleDuration?g(function(){b(j)},k.throttleDuration):function(){b(j)};var l=false;b(j);return{adjustFocus:function(){return b(j)},windowOn:function(){if(l){return}a.on("resize",m);return l=true},windowOff:function(){if(!l){return}a.off("resize",m);l=false;return true}}};e.fn.focusPoint=function(j){if(typeof j==="string"){return this.each(function(){var l=e(this);l.data("focusPoint")[j]()})}var k=e.extend({},c,j);return this.each(function(){var m=e(this);var l=f(m,k);if(m.data("focusPoint")){m.data("focusPoint").windowOff()}m.data("focusPoint",l);if(k.reCalcOnWindowResize){l.windowOn()}})};e.fn.adjustFocus=function(){return this.each(function(){b(e(this))})}})(jQuery);